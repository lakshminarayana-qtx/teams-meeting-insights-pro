import{r as a,a as q,R as z}from"./vendor-nf7bT_Uh.js";import{P as U,C}from"./graph-Z1oC2IgG.js";import{L as J,D as B}from"./teams-W1BILDso.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function u(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(s){if(s.ep)return;s.ep=!0;const n=u(s);fetch(s.href,n)}})();var A={exports:{}},y={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var K=a,W=Symbol.for("react.element"),Y=Symbol.for("react.fragment"),Q=Object.prototype.hasOwnProperty,Z=K.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,H={key:!0,ref:!0,__self:!0,__source:!0};function T(p,r,u){var o,s={},n=null,c=null;u!==void 0&&(n=""+u),r.key!==void 0&&(n=""+r.key),r.ref!==void 0&&(c=r.ref);for(o in r)Q.call(r,o)&&!H.hasOwnProperty(o)&&(s[o]=r[o]);if(p&&p.defaultProps)for(o in r=p.defaultProps,r)s[o]===void 0&&(s[o]=r[o]);return{$$typeof:W,type:p,key:n,ref:c,props:s,_owner:Z.current}}y.Fragment=Y;y.jsx=T;y.jsxs=T;A.exports=y;var e=A.exports,N={},P=q;N.createRoot=P.createRoot,N.hydrateRoot=P.hydrateRoot;const V="your-gemini-api-key-here",X="your-azure-client-id-here",ee={auth:{clientId:X,authority:"https://login.microsoftonline.com/common",redirectUri:window.location.origin}},x=new U(ee),R={mom:"Generate comprehensive Minutes of Meeting from this transcript with key decisions, discussions, and participants:",actionItems:"Extract all action items with assigned owners and deadlines from this meeting transcript:",summary:"Create a concise 3-bullet executive summary of this meeting:",notes:"Extract the most important notes and key takeaways from this meeting:",insights:"Analyze this meeting for key insights, trends, and recommendations:",followUp:"Identify follow-up actions and next steps from this meeting:"};function te(){const[p,r]=a.useState(null),[u,o]=a.useState([]),[s,n]=a.useState(""),[c,_]=a.useState("mom"),[j,E]=a.useState(""),[h,g]=a.useState(!1),[b,l]=a.useState(""),[se,w]=a.useState(null),[O,S]=a.useState(!1);a.useEffect(()=>{J().then(()=>{B().then(r)}),k()},[]);const k=async()=>{try{await x.initialize();const t=x.getAllAccounts();if(t.length>0){const i={scopes:["https://graph.microsoft.com/OnlineMeetings.Read","https://graph.microsoft.com/Calendars.Read"],account:t[0]},d=await x.acquireTokenSilent(i),m=C.init({authProvider:f=>f(null,d.accessToken)});w(m),S(!0),await I(m)}}catch(t){console.error("Graph initialization failed:",t)}},F=async()=>{try{const t={scopes:["https://graph.microsoft.com/OnlineMeetings.Read","https://graph.microsoft.com/Calendars.Read"]},i=await x.loginPopup(t),d=C.init({authProvider:m=>m(null,i.accessToken)});w(d),S(!0),await I(d)}catch{l("Failed to authenticate with Microsoft Graph")}},I=async t=>{try{g(!0),l("");const i=await t.api("/me/events").filter("isOnlineMeeting eq true").orderby("start/dateTime desc").top(25).get();o(i.value||[])}catch{l("Failed to fetch meetings")}finally{g(!1)}},L=async t=>{try{return`
        Meeting started at 10:00 AM
        Attendees: John Smith, Sarah Johnson, Mike Chen
        
        Discussion Points:
        1. Project timeline review
        2. Budget allocation for Q3
        3. Resource planning
        
        Decisions Made:
        - Approved budget increase of 15%
        - Extended project deadline by 2 weeks
        - Assigned Sarah as project lead
        
        Action Items:
        - John to prepare cost breakdown by Friday
        - Sarah to update project timeline
        - Mike to coordinate with IT department
        
        Next meeting scheduled for next Tuesday at 2:00 PM
      `}catch{return l("Failed to fetch transcript. This is a demo version."),null}},D=async()=>{var t,i,d,m,f;if(!s){l("Please select a meeting first");return}try{g(!0),l("");const v=await L(s);if(!v)return;const M=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${V}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:`${R[c]}

${v}`}]}]})});if(!M.ok)throw new Error("Failed to generate insights");const $=await M.json();E(((f=(m=(d=(i=(t=$.candidates)==null?void 0:t[0])==null?void 0:i.content)==null?void 0:d.parts)==null?void 0:m[0])==null?void 0:f.text)||"No insights generated")}catch{l("Failed to generate insights. Please check your API key.")}finally{g(!1)}},G=()=>{navigator.clipboard.writeText(j)};return e.jsxs("div",{className:"teams-app",children:[e.jsx("div",{className:"app-header",children:e.jsxs("div",{className:"header-content",children:[e.jsxs("h1",{className:"app-title",children:[e.jsx("span",{className:"icon",children:"üéØ"}),"Teams Meeting Insights Pro"]}),e.jsx("p",{className:"app-subtitle",children:"AI-powered meeting analysis and documentation"})]})}),e.jsx("div",{className:"app-container",children:O?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"control-panel",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Select Meeting"}),e.jsxs("select",{className:"form-select",value:s,onChange:t=>n(t.target.value),disabled:h,children:[e.jsx("option",{value:"",children:"Choose a recent meeting..."}),u.map(t=>e.jsxs("option",{value:t.id,children:[t.subject," - ",new Date(t.start.dateTime).toLocaleDateString()]},t.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Analysis Type"}),e.jsx("div",{className:"button-group",children:Object.entries(R).map(([t,i])=>e.jsx("button",{className:`option-button ${c===t?"active":""}`,onClick:()=>_(t),disabled:h,children:t==="mom"?"Minutes":t==="actionItems"?"Action Items":t==="summary"?"Summary":t==="notes"?"Notes":t==="insights"?"Insights":t==="followUp"?"Follow-up":t},t))})]}),e.jsx("button",{className:"generate-button",onClick:D,disabled:h||!s,children:h?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner"}),"Analyzing Meeting..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"icon",children:"‚ú®"}),"Generate Insights"]})})]}),b&&e.jsxs("div",{className:"error-message",children:[e.jsx("span",{className:"error-icon",children:"‚ö†Ô∏è"}),b]}),j&&e.jsxs("div",{className:"result-panel",children:[e.jsxs("div",{className:"result-header",children:[e.jsx("h3",{children:"Generated Analysis"}),e.jsx("button",{className:"copy-button",onClick:G,children:"üìã Copy to Clipboard"})]}),e.jsx("div",{className:"result-content",children:e.jsx("pre",{children:j})})]})]}):e.jsx("div",{className:"auth-prompt",children:e.jsxs("div",{className:"auth-content",children:[e.jsx("h3",{children:"Welcome to Meeting Insights Pro"}),e.jsx("p",{children:"Sign in with your Microsoft account to access your Teams meetings and generate AI-powered insights"}),e.jsxs("button",{className:"auth-button",onClick:F,children:[e.jsx("span",{className:"icon",children:"üîê"}),"Sign in with Microsoft"]})]})})})]})}N.createRoot(document.getElementById("root")).render(e.jsx(z.StrictMode,{children:e.jsx(te,{})}));
//# sourceMappingURL=index-DlHd5mT4.js.map
